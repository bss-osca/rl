---
title: "Generating random numbers"
author: "Lars Relund Nielsen"
output:
  xaringan::moon_reader:
    css: "./libs/slides.css"
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightLines: true
      highlightStyle: solarized-light
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---

```{r, child = "setup.Rmd", echo=FALSE}
```

```{r include=FALSE}
# use xaringan::inf_mr(cast_from = ".") to preview
```

layout: true

<div class="my-footer">
<span>
<a href="https://bss-osca.github.io/tfa/mod-vba-random-numbers" target="_blank">Book</a> | <a href="https://bss-osca.github.io/tfa/slides/03-01_vba-random-numbers-slides.html" target="_blank">Slides</a> | <a href="https://github.com/bss-osca/tfa/blob/master/slides/03-01_vba-random-numbers-slides.Rmd" target="_blank">Source</a> | <a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-random-numbers-template.xlsm" target="_blank">Excel</a>
</span>
</div> 

---

## Generating random numbers

- Often we want to model a system where some of the elements are uncertain. 
- To simulate the system we want to generate some random numbers following different distributions. This can be done using the built-in VBA and Excel functions.
- Initialize generation of random numbers using 
  ```
  Randomize()     ' chooses a random seed 
  ```
  Or
  ```
  Randomize(100)     ' generate the same random numbers
  ```
  We normally use the first option.
- When generating random numbers in VBA and writing them to the worksheet, they will NOT be changed when the worksheet is updated! Only when the code is executed!

---

## Examples on distributions

- Uniform between 0 and 1: `Rnd()`
- Uniform between i and j:  `i + (j - i) * Rnd`
- Normal distribution: `WorksheetFunction.NormInv(Rnd, dblMean, dblSD)`
- Binomial distribution: `WorksheetFunction.Binom_Inv(intTrials, dblPr, Rnd)`

Let us try some examples using module `A_Random` in this [Excel file](https://github.com/bss-osca/tfa/blob/master/vba/vba-random-numbers-template.xlsm).
---

## Simulation

Given an uncertain system we simulate the system by constructing a 

- Deterministic model (that is we assume the random numbers have some specific values) and algorithms for solving it. 
- Generate random numbers and used to solve the model and store the results. 
- Repeat a number of times and calculate statistics such as min, mean and standard deviation.

For example if the profit is $f(x) = 2x^2 + 5x + 123$ and x is normal distributed with mean 100 and std. dev. 20. We may simulate the profit. See module `B_Simulation` in this [Excel file](https://github.com/bss-osca/tfa/blob/master/vba/vba-random-numbers-template.xlsm).

```{r copy to docs, include=FALSE}
file.copy(list.files(pattern = ".html"), "../docs/slides/", overwrite = T)
file.copy("./slides.css", "./libs/", overwrite = T)
file.copy("libs", "../docs/slides/", recursive = T)
file.copy("img", "../docs/slides/", recursive = T)
system2("Rscript", args = "-e 'rmarkdown::render(\"index.Rmd\", quiet = TRUE)'")
```